{# src/OC/PlatformBundle/Resources/views/Advert/index.html.twig #}

{% extends "OCPlatformBundle::layout.html.twig" %}

{% block title %}
    Accueil - {{ parent() }}
{% endblock %}

{% block ocplatform_body %}

    <h2>Liste des annonces</h2>

    <ul>
        {% for advert in listAdverts %}
            <li>
                <a href="{{ path('oc_platform_view', {'id': advert.id}) }}">
                    {{ advert.title }}
                </a>
                par {{ advert.author }},
                le {{ advert.date|date('d/m/Y') }}

                {% if advert.advertSkills is not empty %}
                    - (Comp√©tences requises :
                    {% for advSkill in advert.advertSkills %}
                        <b>{{ advSkill.skill.name }}</b>:<i>{{ advSkill.level }}</i> {% if not loop.last %};{% endif %}
                    {% endfor %}
                    )
                {% endif %}
            </li>
        {% else %}
            <li>Pas (encore !) d'annonces</li>
        {% endfor %}
    </ul>

    <h3>Paginator de Doctrine </h3>
    <div class="text-center">
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                {% if page != 1 %}
                    <li class="page-item">
                        <a class="page-link" href="{{ path('oc_platform_home', {'page' : page-1}) }}"
                           aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                {% endif %}
                {% for i in range(1, nbPages) %}
                    <li {% if i == page %} class="active" {% endif %}>

                        <a href="{{ path('oc_platform_home', {'page' : i}) }}">{{ i }}</a>
                    </li>
                {% endfor %}
                {% if page != nbPages %}
                    <li class="page-item">
                        <a class="page-link" href="{{ path('oc_platform_home', {'page' : page+1}) }}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>

    <h3>Utilisation du bundle <b>knp_paginator</b></h3>

    <table>
        <tr>
            {# sorting of properties based on query components #}
            <th>{{ knp_pagination_sortable(pagination, 'Id', 'a.id') }}</th>
            <th{% if pagination.isSorted('a.Title') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Title', 'a.title') }}</th>
            <th>{{ knp_pagination_sortable(pagination, 'Contenu', ['a.date']) }}</th>
        </tr>
        {# table body #}
        {% for article in pagination %}

            <tr {% if loop.index is odd %} class="tablebgcolor" {% endif %}>
                <td>{{ article.id }}</td>
                <td>{{ article.title }}</td>
                <td>{{ article.content }}</td>
            </tr>
            <tr class="blank_row" style="height: 25px !important;">
                <td colspan="3"></td>
            </tr>

        {% endfor %}
    </table>
    {# display navigation #}
    <div class="navigation">
        {{ knp_pagination_render(pagination) }}
    </div>



{% endblock %}